<!doctype html>
<html>
   <head>
      <title>Guild Wars 2</title>

      <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>

      <script type="text/javascript">
         var all;

         $(document).ready(function() {
            all = get_json('items.json');

            var i;
            var recipe = get_json('recipes/1275.json');
            var output = get_json('items/' + recipe['output_item_id'] + '.json');
            var input = new Array();
            for (i = 0; i < recipe['ingredients'].length; i++) {
               var item = get_json('items/' + recipe['ingredients'][i]['item_id'] + '.json');
               $('#input').append('<div>' + item['name'] + '</div>');
               $('#input').append('<div><img src="items/' + item['item_id'] + '.png" alt="' + item['name'] + '"></div>');
               input.push(item);
            }

            $('#output').append('<div>' + output['name'] + '</div>');
            $('#output').append('<div><img src="items/' + output['item_id'] + '.png" alt="' + output['name'] + '"></div>');
         });

         function get_json(url) {
            var obj;

            $.ajax({
               url: url,
               async: false,
               success: function(json) {
                  obj = json;
               }
            });

            return obj;
         }

         function search_recipes() {
            $('#searchresults').html('');
            for (var i = 0; i < all.length; i++) {
               if (all[i]['name'].toUpperCase().indexOf($('#searchbox').val().toUpperCase()) == 0) {
                  $('#searchresults').append('<div>' + all[i]['name'] + '</div>');
               }
            }
         }
      </script>
   </head>
   <body>

      <div id="search">
         <div>
            <input type="text" id="searchbox" name="searchbox">
            <input type="button" onclick="search_recipes(); return false;">
         </div>
         <div id="searchresults">
         </div>
      </div>

      <div id="input">
      </div>

      <div id="output">
      </div>

   </body>
</html>
